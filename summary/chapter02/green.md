# 2장. 테스트

생성일: 2024-03-21
최종수정일: 2024-03-21

## 💡 핵심 개념
- 테스트는 애플리케이션의 품질을 보장하는 가장 중요한 수단이다
- TDD는 테스트가 개발을 이끌어가는 방법론이다
- 스프링은 테스트를 위한 다양한 도구와 어노테이션을 제공한다

## 학습 배경
### 현재 프로젝트에서 마주친 문제:
- 웹을 통한 DAO 테스트는 준비과정이 길고 번거롭다
- 오류 발생 시 빠르고 정확한 대응이 어렵다

### 이 개념으로 해결할 수 있는 점:
- 단위 테스트를 통한 빠른 피드백
- 자동화된 테스트로 안정적인 코드 유지보수
- 스프링의 테스트 지원으로 효율적인 테스트 환경 구축

## 주요 개념

### 1. TDD (Test Driven Development)
**Why**: 코드의 품질을 보장하고 리팩토링을 안전하게 수행하기 위해
**What**: 테스트 코드를 먼저 작성하고, 이를 통과하는 실제 코드를 구현하는 개발 방식
**How**:
- 실패하는 테스트 작성 → 테스트 통과하는 코드 작성 → 리팩토링
- 테스트-코드 작성 주기를 최대한 짧게 유지

### 2. JUnit 테스트 실행 프로세스
```java
1. @Test 메소드 스캔
2. 테스트 클래스 오브젝트 생성
3. @Before 메소드 실행
4. @Test 메소드 실행
5. @After 메소드 실행
6. 2-5단계 반복
7. 전체 테스트 결과 리포트
```

### 3. 스프링 테스트 어노테이션
**@RunWith(SpringJUnit4ClassRunner.class)**
- JUnit 프레임워크의 테스트 실행 방법을 확장
- 스프링 테스트 컨텍스트 프레임워크와 JUnit을 연동

**@ContextConfiguration**
- 테스트에서 사용할 스프링 설정 파일의 위치를 지정
- locations 속성으로 XML 설정 파일 경로를 설정할 수 있음

```java
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(locations = "/applicationContext.xml")
public class UserDaoTest {
    // ...
}
```

**@Autowired**
- 변경 전:
```java
this.dao = this.context.getBean("userDao", UserDao.class);
```
- 변경 후:
```java
@Autowired
private UserDao dao;
```

주의점:
- 같은 타입의 빈이 두 개 이상 있을 경우 변수명으로 빈을 찾음
- 변수명으로도 찾을 수 없는 경우 예외 발생

### 4. DI 테스트 방법
1. 컨테이너 없는 DI 테스트
    - 가장 빠르고 간단한 방법
    - 단순한 오브젝트 테스트에 적합

2. 스프링 설정을 이용한 DI 테스트
    - 복잡한 의존관계를 가진 오브젝트 테스트에 적합
    - XML 설정 파일 활용

3. @DirtiesContext를 이용한 DI 테스트
    - 테스트에서 애플리케이션 컨텍스트의 구성이나 상태를 변경할 때 사용
    - 컨텍스트 공유를 허용하지 않음

### 5. 버그 테스트
- 목적: 오류를 재현하고 수정을 검증
- 장점:
    - 테스트 완성도 향상
    - 버그 분석 용이
    - 기술적 문제 해결에 도움

## 질문과 생각
❓ @DirtiesContext를 사용하면 성능에 어떤 영향이 있을까?
→ 테스트마다 애��리케이션 컨텍스트를 새로 생성해야 해서 초기화 시간이 증가
→ 다른 테스트와 컨텍스트를 공유할 수 없어 메모리 사용량이 증가
📚 스프링의 다른 테스트 관련 어노테이션들에 대해 학습 필요
💡 현재 프로젝트의 테스트 코드에 TDD 적용 고려

## 북마크
📎 JUnit 테스트 실행 프로세스
📎 @Autowired 사용 시 주의사항
📎 DI 테스트 세 가지 방법
